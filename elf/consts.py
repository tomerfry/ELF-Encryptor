

ELF_FILE_HEADER_FORMAT = '16sHHIQQQIHHHHHH'
PHDR_STRUCT_FORMAT = 'IIQQQQQQ'
SHDR_STRUCT_FORMAT = 'IIQQQQIIQQ'
STUB_SIZE = 0x1000
PAGE_SIZE = 0x20000

READ_PERM = 0b100
WRITE_PERM = 0b010
EXEC_PERM = 0b001

PT_NULL = 0x00000000
PT_LOAD = 0x00000001
PT_DYNAMIC = 0x00000002
PT_INTERP = 0x00000003
PT_NOTE = 0x00000004
PT_SHLIB = 0x00000005
PT_PHDR = 0x00000006
PT_TLS = 0x00000007
PT_LOOS = 0x60000000
PT_HIOS = 0x6FFFFFFF
PT_LOPROC = 0x70000000
PT_HIPROC = 0x7FFFFFFF

STUB_PROGRAM = """
[bits 64]

jmp $
"""
STUB_ENTRY = 64 + (56 * 3)